version: "3.8"

services:
  # # voice-api (임시 비활성화)
  # voice-api:
  #   image: ghcr.io/amore-gg/amore-ai-voice:latest
  #   container_name: voice-api
  #   ports:
  #     - "1000:1000"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #   volumes:
  #     - voice_output:/app/generated_audio
  #   restart: unless-stopped

  # # lip-api (임시 비활성화)
  # lip-api:
  #   image: ghcr.io/amore-gg/amore-ai-lip:latest
  #   container_name: lip-api
  #   ports:
  #     - "2000:2000"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #   volumes:
  #     - lip_output:/app/results
  #     - lip_uploads:/app/uploads
  #     - /home/ubuntu/amore-ai/lip/checkpoints:/app/checkpoints
  #     - /home/ubuntu/amore-ai/lip/face_detection/detection/sfd/s3fd.pth:/app/face_detection/detection/sfd/s3fd.pth
  #   restart: unless-stopped

  # elevenlabs-api:
  #   image: ghcr.io/amore-gg/amore-ai-elevenlabs:latest
  #   container_name: elevenlabs-api
  #   ports:
  #     - "1100:1100"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #     - ELEVENLABS_API_KEY=${ELEVENLABS_API_KEY}
  #   volumes:
  #     - elevenlabs_output:/app/generated_audio
  #   restart: unless-stopped

  # video-qwen-api:
  #   image: ghcr.io/amore-gg/amore-ai-video-qwen:latest
  #   container_name: video-qwen-api
  #   ports:
  #     - "4100:4100"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #     - COMFYUI_URL=${COMFYUI_URL}
  #   volumes:
  #     - qwen_uploads:/app/uploads
  #     - qwen_outputs:/app/outputs
  #   restart: unless-stopped

  # video-i2v-api:
  #   image: ghcr.io/amore-gg/amore-ai-video-i2v:latest
  #   container_name: video-i2v-api
  #   ports:
  #     - "4200:4200"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #     - COMFYUI_URL=${COMFYUI_URL}
  #   volumes:
  #     - i2v_uploads:/app/uploads
  #     - i2v_outputs:/app/outputs
  #   restart: unless-stopped
  

  scenario-qwen-api:
    image: ghcr.io/amore-gg/amore-ai-scenario-qwen-api:latest
    container_name: scenario-qwen-api
    ports:
      - "3000:3000"  # 4100:4100은 제거, 오직 3000 포트만 사용
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL}
      - MODEL_DIR=/app/safetensors
    volumes:
      - /home/ubuntu/amore-ai/scenario/safetensors:/app/safetensors
      - qwen2.5_uploads:/app/uploads
      - qwen2.5_outputs:/app/outputs
    restart: unless-stopped

volumes:
  # voice_output:  # 임시 비활성화
  # lip_output:    # 임시 비활성화
  # lip_uploads:   # 임시 비활성화
  elevenlabs_output:
  qwen_uploads:
  qwen_outputs:
  i2v_uploads:
  i2v_outputs:
  qwen2.5_uploads:
  qwen2.5_outputs:
