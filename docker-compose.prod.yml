version: "3.8"
services:

  # # voice-api (zonos)
  # voice-api:
  #   image: ghcr.io/amore-gg/amore-ai-voice:latest
  #   container_name: voice-api
  #   ports:
  #     - "1000:1000"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #   volumes:
  #     - voice_output:/app/generated_audio
  #   restart: unless-stopped

  # # lip-api (wav2lip)
  # lip-api:
  #   image: ghcr.io/amore-gg/amore-ai-lip:latest
  #   container_name: lip-api
  #   ports:
  #     - "2000:2000"
  #   environment:
  #     - ENV=prod
  #     - PYTHONUNBUFFERED=1
  #   volumes:
  #     - lip_output:/app/results
  #     - lip_uploads:/app/uploads
  #     - /home/ubuntu/amore-ai/lip/checkpoints:/app/checkpoints
  #     - /home/ubuntu/amore-ai/lip/face_detection/detection/sfd/s3fd.pth:/app/face_detection/detection/sfd/s3fd.pth
  #   restart: unless-stopped

  elevenlabs-api:
    image: ghcr.io/amore-gg/amore-ai-elevenlabs:latest
    container_name: elevenlabs-api
    ports:
      - "1100:1100"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - ELEVENLABS_API_KEY=${ELEVENLABS_API_KEY}
    volumes:
      - elevenlabs_output:/app/generated_audio
      - shared_media:/app/shared
    restart: unless-stopped

  video-qwen-api:
    image: ghcr.io/amore-gg/amore-ai-video-qwen:latest
    container_name: video-qwen-api
    ports:
      - "4100:4100"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL}
    volumes:
      - qwen_uploads:/app/uploads
      - qwen_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  video-i2v-api:
    image: ghcr.io/amore-gg/amore-ai-video-i2v:latest
    container_name: video-i2v-api
    ports:
      - "4200:4200"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL}
    volumes:
      - i2v_uploads:/app/uploads
      - i2v_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped
  

  scenario-exaone-api:
    image: ghcr.io/amore-gg/amore-ai-scenario-exaone-api:latest
    container_name: scenario-exaone-api
    ports:
      - "3000:3000"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - NVIDIA_VISIBLE_DEVICES=all
    volumes:
      - exaone_uploads:/app/uploads
      - exaone_outputs:/app/outputs
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    restart: unless-stopped

  latentsync-api:
    image: ghcr.io/amore-gg/amore-ai-latentsync-api:latest
    container_name: latentsync-api
    ports:
      - "2100:2100"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL}
    volumes:
      - latentsync_uploads:/app/uploads
      - latentsync_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  mmaudio-api:
    image: ghcr.io/amore-gg/amore-ai-mmaudio-api:latest
    container_name: mmaudio-api
    ports:
      - "4300:4300"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL}
    volumes:
      - mmaudio_uploads:/app/uploads
      - mmaudio_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  merge-api:
    image: ghcr.io/amore-gg/amore-ai-merge-api:latest
    container_name: merge-api
    ports:
      - "5000:5000"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
    volumes:
      - merge_uploads:/app/uploads
      - merge_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  zimage-api:
    image: ghcr.io/amore-gg/amore-ai-zimage-api:latest
    container_name: zimage-api
    ports:
      - "4400:4400"
    environment:
      - ENV=prod
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL}
    volumes:
      - zimage_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

volumes:
  # voice_output:  # 비활성화
  # lip_output:    # 비활성화
  # lip_uploads:   # 비활성화
  elevenlabs_output:
  qwen_uploads:
  qwen_outputs:
  i2v_uploads:
  i2v_outputs:
  exaone_uploads:
  exaone_outputs:
  latentsync_uploads:
  latentsync_outputs:
  mmaudio_uploads:
  mmaudio_outputs:
  merge_uploads:
  merge_outputs:
  zimage_outputs:
  shared_media: