version: "3.8"

services:
  voice-api:
    build:
      context: ./voice/zonos_api_package
      dockerfile: Dockerfile
    container_name: voice-api-dev
    ports:
      - "1000:1000"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
    volumes:
      - voice_output:/app/generated_audio
    restart: unless-stopped

  lip-api:
    build:
      context: ./lip/Wav2Lip-master
      dockerfile: Dockerfile
    container_name: lip-api-dev
    ports:
      - "2000:2000"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
    volumes:
      - lip_output:/app/results
      - lip_uploads:/app/uploads
    restart: unless-stopped

  elevenlabs-api:
    build:
      context: ./voice/eleven_labs
      dockerfile: Dockerfile
    container_name: elevenlabs-api-dev
    ports:
      - "1100:1100"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
      - ELEVENLABS_API_KEY=${ELEVENLABS_API_KEY}
    volumes:
      - elevenlabs_output:/app/generated_audio
    restart: unless-stopped

  video-qwen-api:
    build:
      context: ./video/image/qwen
      dockerfile: Dockerfile
    container_name: video-qwen-api-dev
    ports:
      - "4100:4100"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL:-http://host.docker.internal:8000}
    volumes:
      - qwen_uploads:/app/uploads
      - qwen_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  video-i2v-api:
    build:
      context: ./video/i2v/wan2
      dockerfile: Dockerfile
    container_name: video-i2v-api-dev
    ports:
      - "4200:4200"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL:-http://host.docker.internal:8000}
    volumes:
      - i2v_uploads:/app/uploads
      - i2v_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped
  scenario-exaone-api:
    build:
      context: ./scenario/exaone
      dockerfile: Dockerfile
    container_name: scenario-exaone-api-dev
    ports:
      - "3000:3000"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
    volumes:
      - exaone_uploads:/app/uploads
      - exaone_outputs:/app/outputs
    restart: unless-stopped

  latentsync-api:
    build:
      context: ./lip/Latentsync
      dockerfile: Dockerfile
    container_name: latentsync-api-dev
    ports:
      - "2100:2100"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL:-http://host.docker.internal:8000}
    volumes:
      - latentsync_uploads:/app/uploads
      - latentsync_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  mmaudio-api:
    build:
      context: ./video/sound/mmaudio
      dockerfile: Dockerfile
    container_name: mmaudio-api-dev
    ports:
      - "4300:4300"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL:-http://host.docker.internal:8000}
    volumes:
      - mmaudio_uploads:/app/uploads
      - mmaudio_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  merge-api:
    build:
      context: ./api
      dockerfile: Dockerfile
    container_name: merge-api-dev
    ports:
      - "5000:5000"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
    volumes:
      - merge_uploads:/app/uploads
      - merge_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

  zimage-api:
    build:
      context: ./video/image/z_image
      dockerfile: Dockerfile
    container_name: zimage-api-dev
    ports:
      - "4400:4400"
    environment:
      - ENV=dev
      - PYTHONUNBUFFERED=1
      - COMFYUI_URL=${COMFYUI_URL:-http://host.docker.internal:8000}
    volumes:
      - zimage_outputs:/app/outputs
      - shared_media:/app/shared
    restart: unless-stopped

volumes:
  voice_output:
  lip_output:
  lip_uploads:
  elevenlabs_output:
  qwen_uploads:
  qwen_outputs:
  i2v_uploads:
  i2v_outputs:
  exaone_uploads:
  exaone_outputs:
  latentsync_uploads:
  latentsync_outputs:
  mmaudio_uploads:
  mmaudio_outputs:
  merge_uploads:
  merge_outputs:
  zimage_outputs:
  shared_media: